(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-483cb784"],{"67cd":function(t,e,a){"use strict";a("b412")},b412:function(t,e,a){},b789:function(t,e,a){"use strict";a.r(e);var c=a("7a23");const s={class:"cart-page"},o={class:"cart-header"},i={key:0,class:"items-count"},n={key:0,class:"cart-content"},l={class:"cart-items"},r=["src","alt"],u={class:"item-info"},d={class:"item-meta"},b={class:"quantity-controls"},p=["onClick"],m=["onClick"],O={class:"price"},j=["onClick"],h={class:"cart-summary"},y={class:"summary-details"},v={class:"summary-row"},f={class:"summary-total"},k={class:"form-group"},g={class:"form-row"},C={class:"form-group"},I={class:"form-group"},w={class:"form-group"},P=["disabled"],_={key:1,class:"empty-cart"};function x(t,e,a,x,S,q){const A=Object(c["D"])("router-link");return Object(c["x"])(),Object(c["h"])("div",s,[Object(c["i"])("div",o,[e[7]||(e[7]=Object(c["i"])("h1",null,"Shopping Cart",-1)),t.cart.state.items.length?(Object(c["x"])(),Object(c["h"])("p",i,Object(c["H"])(t.cart.state.items.length)+" items in your cart ",1)):Object(c["g"])("",!0)]),t.cart.state.items.length?(Object(c["x"])(),Object(c["h"])("div",n,[Object(c["i"])("div",l,[(Object(c["x"])(!0),Object(c["h"])(c["a"],null,Object(c["B"])(t.cart.state.items,a=>(Object(c["x"])(),Object(c["h"])("div",{key:a.id,class:"cart-item"},[Object(c["i"])("img",{src:a.image_url,alt:a.name},null,8,r),Object(c["i"])("div",u,[Object(c["i"])("h3",null,Object(c["H"])(a.name),1),Object(c["i"])("div",d,[Object(c["i"])("div",b,[Object(c["i"])("button",{onClick:e=>t.decrementQuantity(a)},"-",8,p),Object(c["i"])("span",null,Object(c["H"])(a.quantity),1),Object(c["i"])("button",{onClick:e=>t.incrementQuantity(a)},"+",8,m)]),Object(c["i"])("div",O,"$"+Object(c["H"])((a.price*a.quantity).toFixed(2)),1)])]),Object(c["i"])("button",{class:"remove-button",onClick:e=>t.removeItem(a)},e[8]||(e[8]=[Object(c["i"])("span",{class:"material-symbols-rounded"},"delete",-1)]),8,j)]))),128))]),Object(c["i"])("div",h,[e[18]||(e[18]=Object(c["i"])("h2",null,"Order Summary",-1)),Object(c["i"])("div",y,[Object(c["i"])("div",v,[e[9]||(e[9]=Object(c["i"])("span",null,"Subtotal",-1)),Object(c["i"])("span",null,"$"+Object(c["H"])(t.cart.state.total.toFixed(2)),1)]),e[11]||(e[11]=Object(c["i"])("div",{class:"summary-row"},[Object(c["i"])("span",null,"Shipping"),Object(c["i"])("span",null,"Free")],-1)),Object(c["i"])("div",f,[e[10]||(e[10]=Object(c["i"])("span",null,"Total",-1)),Object(c["i"])("span",null,"$"+Object(c["H"])(t.cart.state.total.toFixed(2)),1)])]),Object(c["i"])("form",{onSubmit:e[6]||(e[6]=Object(c["R"])((...e)=>t.startCheckout&&t.startCheckout(...e),["prevent"])),class:"checkout-form"},[Object(c["i"])("div",k,[e[12]||(e[12]=Object(c["i"])("label",null,"Street and House Number",-1)),Object(c["P"])(Object(c["i"])("input",{"onUpdate:modelValue":e[0]||(e[0]=e=>t.checkoutInfo.address=e),type:"text",required:"",placeholder:"e.g., Hoofdstraat 1"},null,512),[[c["M"],t.checkoutInfo.address]])]),Object(c["i"])("div",g,[Object(c["i"])("div",C,[e[13]||(e[13]=Object(c["i"])("label",null,"Postal Code",-1)),Object(c["P"])(Object(c["i"])("input",{"onUpdate:modelValue":e[1]||(e[1]=e=>t.checkoutInfo.postalCode=e),type:"text",pattern:"[1-9][0-9]{3}\\s?[A-Za-z]{2}",required:"",placeholder:"1234 AB",onInput:e[2]||(e[2]=(...e)=>t.formatPostalCode&&t.formatPostalCode(...e))},null,544),[[c["M"],t.checkoutInfo.postalCode]])]),Object(c["i"])("div",I,[e[14]||(e[14]=Object(c["i"])("label",null,"City",-1)),Object(c["P"])(Object(c["i"])("input",{"onUpdate:modelValue":e[3]||(e[3]=e=>t.checkoutInfo.city=e),type:"text",required:"",placeholder:"Amsterdam"},null,512),[[c["M"],t.checkoutInfo.city]])])]),e[17]||(e[17]=Object(c["i"])("div",{class:"form-group"},[Object(c["i"])("label",null,"Country"),Object(c["i"])("input",{type:"text",value:"Netherlands",disabled:"",class:"disabled-input"})],-1)),Object(c["i"])("div",w,[e[15]||(e[15]=Object(c["i"])("label",null,"Phone Number",-1)),Object(c["P"])(Object(c["i"])("input",{"onUpdate:modelValue":e[4]||(e[4]=e=>t.checkoutInfo.phone=e),type:"tel",pattern:"^(\\+31|0)[0-9]{9}$",required:"",placeholder:"+31612345678",onInput:e[5]||(e[5]=(...e)=>t.formatPhoneNumber&&t.formatPhoneNumber(...e))},null,544),[[c["M"],t.checkoutInfo.phone]])]),Object(c["i"])("button",{type:"submit",class:"checkout-button",disabled:!t.isFormValid||0===t.cart.state.items.length},[e[16]||(e[16]=Object(c["i"])("span",{class:"material-symbols-rounded"},"payments",-1)),Object(c["k"])(" Pay â‚¬"+Object(c["H"])(t.cart.state.total.toFixed(2)),1)],8,P)],32)])])):(Object(c["x"])(),Object(c["h"])("div",_,[e[20]||(e[20]=Object(c["i"])("span",{class:"material-symbols-rounded"},"shopping_cart",-1)),e[21]||(e[21]=Object(c["i"])("h2",null,"Your cart is empty",-1)),e[22]||(e[22]=Object(c["i"])("p",null,"Looks like you haven't added anything to your cart yet",-1)),Object(c["l"])(A,{to:"/store",class:"continue-shopping"},{default:Object(c["O"])(()=>e[19]||(e[19]=[Object(c["k"])(" Continue Shopping ")])),_:1})]))])}var S=a("8c2f"),q=a("4c16"),A=a("79a7"),H=a("889e"),Q=Object(c["m"])({name:"Cart",setup(){const t=Object(c["A"])({address:"",city:"",postalCode:"",phone:"",country:"NL"}),e=Object(c["d"])(()=>(console.log("Form values:",{address:t.value.address,city:t.value.city,postalCode:t.value.postalCode,phone:t.value.phone,regex:{postal:/^[1-9][0-9]{3}\s?[A-Za-z]{2}$/.test(t.value.postalCode),phone:/^(\+31|0)[0-9]{9}$/.test(t.value.phone)}}),t.value.address.length>=3&&t.value.city.length>=2&&/^[1-9][0-9]{3}\s?[A-Za-z]{2}$/.test(t.value.postalCode)&&/^(\+31|0)[0-9]{9}$/.test(t.value.phone)&&S["a"].state.items.length>0));function a(e){let a=e.target.value.toUpperCase();a=a.replace(/[^0-9A-Z]/g,""),a.length>4&&(a=a.slice(0,4)+" "+a.slice(4,6)),t.value.postalCode=a}function s(e){let a=e.target.value.replace(/[^\d+]/g,"");a.startsWith("+31")||(a=a.startsWith("0")?"+31"+a.slice(1):"+31"+a),t.value.phone=a}async function o(){try{const a=await Object(q["a"])("pk_test_51QrkgR4CfmNPourcrOX3w5QB0d3oS76LrpMWcaGU8lnsj7mAc8SlPE3rEDZm8HLpezTqlTvAOwR2QOkl4xFTMAwu00SfIVQ1iY").catch(()=>null);if(a)try{const{data:e,error:c}=await A["a"].functions.invoke("create-payment",{body:{items:S["a"].state.items.map(t=>({...t,price_in_cents:Math.round(100*t.price)})),email:H["a"].state.user.email,user_id:H["a"].state.user.id,shipping_address:t.value}});if(!c&&e.sessionId){const{error:t}=await a.redirectToCheckout({sessionId:e.sessionId});if(!t)return}}catch(e){console.warn("Stripe checkout failed, falling back to manual order:",e)}const{data:c,error:s}=await A["a"].from("orders").insert({user_id:H["a"].state.user.id,items:S["a"].state.items,total_amount:S["a"].state.total,shipping_address:t.value,status:"pending",payment_method:"manual",created_at:(new Date).toISOString()}).select().single();if(s)throw s;S["a"].clear(),alert("Your order has been placed and is pending admin approval."),router.push("/checkout/success?order_id="+c.id)}catch(a){console.error("Checkout error:",a),alert("Payment failed. Please try again.")}}function i(t){S["a"].updateQuantity(t.id,t.quantity+1)}function n(t){t.quantity>1&&S["a"].updateQuantity(t.id,t.quantity-1)}function l(t){S["a"].removeItem(t.id)}return{cart:S["a"],checkoutInfo:t,startCheckout:o,incrementQuantity:i,decrementQuantity:n,removeItem:l,isFormValid:e,formatPostalCode:a,formatPhoneNumber:s}}}),F=(a("67cd"),a("6b0d")),N=a.n(F);const $=N()(Q,[["render",x],["__scopeId","data-v-12b6c248"]]);e["default"]=$}}]);
//# sourceMappingURL=chunk-483cb784.7245b8b7.js.map